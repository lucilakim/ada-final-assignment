DROP DATABASE IF EXISTS CAR_RENTAL;

CREATE DATABASE CAR_RENTAL;

USE CAR_RENTAL;

CREATE TABLE CAR_TYPE (
	CAR_TYPE_NAME VARCHAR(20) PRIMARY KEY
);

INSERT INTO CAR_TYPE (CAR_TYPE_NAME) VALUES ('Sedan'), ('Hatchback'), ('SUV'), ('Van');

CREATE TABLE CAR_BRAND (
	CAR_BRAND VARCHAR(20) PRIMARY KEY
);
	
INSERT INTO CAR_BRAND (CAR_BRAND) VALUES ('Renault'), ('Subaru'), ('Lexus'), ('Ford'), ('Honda'), ('Toyota'), ('Audi'), ('BMW');

CREATE TABLE CAR (
	 CAR_PLATE_ID VARCHAR(6) PRIMARY KEY
	,BRAND VARCHAR(20) NOT NULL
	,MODEL VARCHAR(20) NOT NULL
	,YEAR YEAR NOT NULL
	,COLOR VARCHAR(20) NOT NULL
	,CAR_TYPE VARCHAR(20)
	,PASSENGERS_NUMBER INTEGER NOT NULL
	,MILEAGE INTEGER NOT NULL
	,AIR_CONDITIONING VARCHAR(3) NOT NULL DEFAULT 'N'
    ,DAILY_RENT DECIMAL(10,2) NOT NULL
    ,ASSOCIATED_CONTRACT INTEGER UNSIGNED
    ,FOREIGN KEY (CAR_TYPE) REFERENCES CAR_TYPE(CAR_TYPE_NAME)
    ,FOREIGN KEY (BRAND) REFERENCES CAR_BRAND(CAR_BRAND)
);

INSERT INTO CAR (CAR_PLATE_ID, BRAND, MODEL, YEAR, COLOR, CAR_TYPE, PASSENGERS_NUMBER, MILEAGE, AIR_CONDITIONING, DAILY_RENT,ASSOCIATED_CONTRACT) 
	 VALUES
	  ('ABC123','Renault','Captur','2017','Blue','Van',5,1350,'Yes',30,1000)
	 ,('XBC168','Toyota','Camry XLE','2005','Silver','SUV',4,2520,'No',15,1001)
     ,('PMA458','Honda','Accord EX','2012','Grey','Hatchback',4,1000,'Yes',30,1002)
     ,('HRO281','Lexus','ES 350','2008','Silver','Sedan',5,2530,'No',18, null)
     ,('LBC170','Ford','F250','2017','Blue','Hatchback',5,1754,'Yes',35, null)
     ,('RUV157','Toyota','Camry XLE','2017','Silver','SUV',4,2500,'Yes',20, null)
     ,('MRO335','Lexus','ES 350','2008','Silver','Sedan',5,2530,'Yes',18, null)
     ,('SIW374','Lexus','ES 350','2008','Silver','Sedan',5,2530,'Yes',18, null)
     ,('HLU751','Subaru','Outback','2019','Blue','SUV',5,1754,'Yes',30, null);
     
     
CREATE TABLE CUSTOMER (
	ID_CARD_NUMBER INTEGER(9) UNSIGNED PRIMARY KEY
	,FIRST_NAME VARCHAR(20) NOT NULL
	,LAST_NAME VARCHAR(20) NOT NULL
	,BIRTH_DATE DATE
    ,PHONE_NUMBER VARCHAR(20) NOT NULL
    ,ID_CARD_EXPIRATION DATE NOT NULL
    ,ASSOCIATED_CONTRACT INTEGER UNSIGNED
);

INSERT INTO CUSTOMER (ID_CARD_NUMBER, ID_CARD_EXPIRATION, FIRST_NAME, LAST_NAME, BIRTH_DATE, PHONE_NUMBER, ASSOCIATED_CONTRACT) VALUES
	 (123456789,'1997-03-05','Fernanda','Algodon','2030-03-05','(631) 456-78-90',1000)
	,(304353221,'2033-03-07','Maria','Gonzalez','1990-03-01','(631) 453-18-98',1001)
	,(563134452,'2029-03-20','Javier','Martinez','1985-03-13','(635) 156-72-93',1002)
	,(873635632,'2040-04-25','Rafael','Diaz','1958-07-10','(631) 426-73-40',null)
	,(205353313,'2035-08-10','Gloria','Sanchez','1958-12-11','(633) 454-55-66',null)
	,(132657853,'2040-04-25','Francisco','Neto','1988-07-15','(633) 678-80-15',null)
	,(895867295,'2027-10-14','Armando','Maldonado','1984-09-12','(631) 567-79-14',null)
	;

CREATE TABLE CONTRACT (
	CONTRACT_NUMBER INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY
    ,CAR_PLATE_ID VARCHAR(6) NOT NULL
    ,CUSTOMER_ID INTEGER  UNSIGNED NOT NULL
    ,START_DAY DATE NOT NULL
    ,DURATION INTEGER NOT NULL
    ,AMOUNT_PAID DECIMAL(10,2)
    ,IS_RENTED TINYINT(1)
    ,FOREIGN KEY (CAR_PLATE_ID) REFERENCES CAR(CAR_PLATE_ID)
    ,FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(ID_CARD_NUMBER)
);

ALTER TABLE CONTRACT AUTO_INCREMENT = 1000;

INSERT INTO CONTRACT (CAR_PLATE_ID, IS_RENTED, CUSTOMER_ID, START_DAY, DURATION, AMOUNT_PAID) VALUES
	('ABC123',1,123456789,'2023-02-25',10,200)
    ,('XBC168',1,304353221,'2023-03-01',7,200)
    ,('PMA458',1,563134452,'2023-03-02',7,200)
    ; 

CREATE TABLE USER (
    USERNAME VARCHAR(50) PRIMARY KEY
    ,PASSWORD VARCHAR(50) NOT NULL
    ,EXPIRATION_DATE DATE NOT NULL
);

INSERT INTO USER (USERNAME, PASSWORD, EXPIRATION_DATE) VALUES
	 ('falgodon','abcd123','2035-05-05')
	,('mgonzalez','qsef280','2023-01-01')
	,('jmartinez','vyjk867','2024-01-01')
	,('rdiaz','qmpe308','2024-08-03-01')
	,('gsanchez','smlp358','2023-04-01')
	,('fneto','mgwo136','2025-06-24')
	;
    
COMMIT;